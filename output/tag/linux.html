<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Dimitris Rongotis - linux</title>
        <link rel="stylesheet" href="http://localhost:8000/theme/css/main.css" />
        <link href="http://localhost:8000/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Dimitris Rongotis Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="https://github.com/dimr">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="http://localhost:8000/">Dimitris Rongotis  <strong>Programming stuff, notes and thoughts</strong></a></h1>
                <nav><ul>
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/tags.html">Tags</a></li>
                    <li><a href="http://localhost:8000/pages/about.html">About</a></li>
                    <li><a href="http://localhost:8000/category/posts.html">posts</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://localhost:8000/debsnap-cli.html">Debian snapshot repository cli tool</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-05-18T04:47:56+03:00">
                Published: Wed 18 May 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://localhost:8000/author/dimitris.html">dimitris</a>
        </address>
<p>In <a href="http://localhost:8000/category/posts.html">posts</a>.</p>
<p>tags: <a href="http://localhost:8000/tag/debian.html">debian</a> <a href="http://localhost:8000/tag/linux.html">linux</a> <a href="http://localhost:8000/tag/debsnapshot.html">debsnapshot</a> <a href="http://localhost:8000/tag/python.html">python</a> </p>
</footer><!-- /.post-info --><p><a href="http://snapshot.debian.org/">Debian snapshot repository</a> is</p>
<blockquote>
<p>is a wayback machine that allows access to old packages based on dates and version numbers. It consists of all past and current packages the Debian archive provides.</p>
</blockquote>
<p>As a tarting point for creating this package was that some times xserver transitions were not compatible with the current nvidia proprietary driver, so
when you were upgrading the xserver you had to switch to the nouveau driver. The result was black screen and you either, had to edit xorg.conf and choose
the open source driver or downgrade the nvidi-driver. Since i prefer to use the second one i had to downgrade but there where times that it was
removed from the official repository. This is where the debian snapshot repository comes in handy but in a situation like this with no gui environment
you have to go to another computer, search the package, copy the timestamp that your package was first seen in the repository and manually write
the url to your sources.list file, plus write down how you should update your package cache and ignore the Valid-Until header within the Release files.
So, you need to write some like this</p>
<blockquote>
<p>deb http://snapshot.debian.org/archive/debian/20131221T035435Z unstable main contrib non-free</p>
</blockquote>
<p>and then update the package cache either with apt-get</p>
<blockquote>
<p>apt-get -o Acquire::Check-Valid-Until=false update</p>
</blockquote>
<p>or with aptitude</p>
<blockquote>
<p>aptitude -o Acquire::Check-Valid-Until=false update</p>
</blockquote>
<p>The first thing that came in mind was that i should search for a program that does all this work for me. To my suprise <strong>there is no such thing</strong>.
The closest you can find that interacts with the snapshot server is a program called debsnap that you can find it in the <a href="https://packages.debian.org/sid/devscripts">devscripts</a> package</p>
<p>All these happened while using the debian testing branch for about 3.5 years. At some point, i switched to unstable with the <a href="http://news.siduction.org/">Siduction</a> distro, which is by the way a great choice, and in general you have to be more careful with your upgrades, be careful with upgrading packages, be <strong>more</strong> careful with dist-upgrading packages, <strong>holding</strong> packages -patience is a virtue in unstable-, reading changelogs and eventually downgrading packages.</p>
<p><a href="https://github.com/dimr/debsnapshot-cli">debsnap-cli</a> gives you this extra functionality that extends the available package versions that you can install.
I personally use it a lot :). The last time i used it was when the <a href="https://igurublog.wordpress.com/2016/04/20/heads-up-gtk-3-20-off-to-a-troubled-start/">gtk 3.20 entered the unstable branch </a> and messed up some programs (pavucontrol, file-roller, kazam, gedit) including firefox.</p>
<p>I just queried the snapshot server for firefox with</p>
<blockquote>
<p>debsnap-cli -first-seen -arch amd64 45.0.2-1  firefox</p>
</blockquote>
<p>it found the relevant timestamp, created the url and appended to a snapshot.list file that it creates inside the /etc/apt/sources.list.d/ path</p>
<blockquote>
<p>http://snapshot.debian.org/archive/debian/20160413T160058Z</p>
</blockquote>
<p>see the full documentation on the github page for instructions on how to use it.</p>
<!-- Final note. Building packages in python should be easier, there are way to many resources on line that can give you a clue on how to  -->

<!-- start but in the end you are going to spend a lot of time in a   --><p>There are <a href="http://localhost:8000/debsnap-cli.html#disqus_thread">comments</a>.</p>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://localhost:8000/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://github.com/dimr">github</a></li>
                            <li><a href="https://twitter.com/dim__r">twitter</a></li>
                            <li><a href="/feeds/all.atom.xml">rss</a></li>
                            <li><a href="mailto:dimitris.rongotis@gmail.com">envelope-o</a></li>
                            <li><a href="http://www.vimeo.com">vimeo</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'dmtrsblog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>